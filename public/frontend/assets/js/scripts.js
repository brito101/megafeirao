$((function(){$("body").on("change",'select[name*="filter_"]',(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});var e=$(this),t=$(this).data("index")+1;$.post(e.data("action"),{search:e.val()},(function(e){if("success"===e.status&&($('select[data-index="'+t+'"]').empty(),$.each(e.data,(function(e,a){$('select[data-index="'+t+'"]').append($("<option>",{value:a,text:a}))})),$.each($('select[name*="filter_"]'),(function(e,a){$(a).data("index")>=t+1&&$(a).empty().append($("<option>",{text:"Selecione o filtro anterior",disabled:!0}))})),$(".selectpicker").selectpicker("refresh"),4===t)){let t=e.data.filter((function(e){if(!isNaN(e))return e})),a=t.reduce((function(e,t){return Math.min(e,t)}),t[0]),n=t.reduce((function(e,t){return Math.max(e,t)}),t[0]);$((function(){$("#price-range").slider({range:!0,min:a,max:n,values:[a,n],slide:function(e,t){if($("#price_base_input").val(t.values[0].toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),$("#price_limit_input").val(t.values[1].toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),0==t.handleIndex){let e=$("#base");$.post(e.data("action"),{search:t.values[0]})}if(1==t.handleIndex){let e=$("#limit");$.post(e.data("action"),{search:t.values[1]}).done((function(e){let t=e.data.filter((function(e){if(!isNaN(e))return e})),a=t.reduce((function(e,t){return Math.min(e,t)}),t[0]),n=t.reduce((function(e,t){return Math.max(e,t)}),t[0]);$("#year-range").slider({range:!0,min:a,max:n,values:[a,n],slide:function(e,t){if($("#year_base_input").val(t.values[0]),$("#year_limit_input").val(t.values[1]),0==t.handleIndex){let e=$("#year_base");$.post(e.data("action"),{search:t.values[0]})}if(1==t.handleIndex){let e=$("#year_limit");$.post(e.data("action"),{search:t.values[1]})}}}),$("#year_base_input").val($("#year-range").slider("values",0)),$("#year_limit_input").val($("#year-range").slider("values",1))}))}}}),$("#price_base_input").val($("#price-range").slider("values",0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),$("#price_limit_input").val($("#price-range").slider("values",1).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}))}))}"fail"===e.status&&($.each($('select[name*="filter_"]'),(function(e,a){$(a).data("index")>=t&&$(a).empty().append($("<option>",{text:"Selecione uma opção no filtro anterior."}))})),$(".selectpicker").selectpicker("refresh"))}),"json")}))}));
